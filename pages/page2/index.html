<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Page Title</title>
    <script src="../../node_modules/jquery/dist/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" media="screen" href="../../node_modules/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="../../main.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
    <script src="main.js"></script> -->
    <style type='text/css'>
            .embeddedServiceHelpButton .helpButton .uiButton { background-color: #005290; font-family: "Salesforce Sans", sans-serif; }
            .embeddedServiceHelpButton .helpButton .uiButton:focus { outline: 1px solid #005290; }
            @font-face {
            font-family: 'Salesforce Sans';
            src: url('https://www.sfdcstatic.com/system/shared/common/assets/fonts/SalesforceSans/SalesforceSans-Regular.woff') format('woff'),
    url('https://www.sfdcstatic.com/system/shared/common/assets/fonts/SalesforceSans/SalesforceSans-Regular.ttf') format('truetype');
            }
    </style>



     
</head>
<body>
    <nav class="navbar navbar-light bg-light">
    <a class="navbar-brand" href="#">
        <img src="../../assets/DellTech_Logo_Prm_Blue.jpg" class="d-inline-block align-top" alt="">
    </a>
</nav>
<div class="navigationLink">
                    <a href="../../index.html" target="_blank">Home</a>
                    <a class="active" href="#" >Live Agent (In New Tab)</a>
                    <a href="../page3/index.html" target="_blank">Resume Chat (In New Tab)</a>
</div>
    <!-- SFDC JS-->
    <script type='text/javascript' src='https://service.force.com/embeddedservice/5.0/esw.min.js'></script>
    <!-- <script src="../../mainChatNowworking20180818V3.js"></script>-->
    <script src="../../mainChat.js"></script>
    <!--  <script src="../../sfdccore.js"></script> -->
    <script>
          triggerSnapin();
    </script>    
    
    <div class="new-chat" style="margin-top: 20px;">
        <div class="row justify-content-md-center">
                <div class="col-lg-6 col-md-8 col-sm-12 order-md-1  border rounded">
                                <form class="needs-validation" novalidate="">

                                        <div class="mb-3">
                                                <label for="serviceTag" style="margin-top: 10px;">Service Tag </label>
                                                <div class="input-group">
                                                    <input type="text" class="form-control" id="serviceTag" placeholder="Service Tag example : 261KZ72" required="" value= "261KZ72">
                                                    <div class="invalid-feedback" style="width: 100%;">
                                                       Service Tag is a required field.
                                                    </div>
                                                </div>
                                            </div>

                                    <div class="row"> 
                                    <div class="col-md-6 mb-3">
                                      <label for="firstName">First name</label>
                                      <input type="text" class="form-control" id="firstName" placeholder="" value="" required="">
                                      <div class="invalid-feedback">
                                        Valid first name is required.
                                      </div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                      <label for="lastName">Last name</label>
                                      <input type="text" class="form-control" id="lastName" placeholder="" value="" required="">
                                      <div class="invalid-feedback">
                                        Valid last name is required.
                                      </div>
                                    </div>
                                  </div>
                      
                                  <div class="mb-3">
                                    <label for="emailId">Email ID</label>
                                    <div class="input-group">
                                      <div class="input-group-prepend">
                                        <span class="input-group-text">@</span>
                                      </div>
                                      <input type="text" class="form-control" id="emailId" placeholder="Email Id" required="">
                                      <div class="invalid-feedback" style="width: 100%;">
                                        Your email id is required.
                                      </div>
                                    </div>
                                  </div>
                      
                      
                                  <div class="mb-3">
                                    <label for="phoneNumber">Phone Number</label>
                                    <input type="text" class="form-control" id="phoneNumber" placeholder="Phone Number" required="">
                                    <div class="invalid-feedback">
                                      Please enter your Phone Number.
                                    </div>
                                  </div>
                      
                                  <div class="mb-3">
                                        <label for="issueType">Issue Type</label>
                                        <select class="custom-select d-block w-100" id="issueType" required="">
                                                <option value="">Choose...</option>
                                                <option>Slow Performance</option>
                                                <option>Keyboard not working</option>
                                                <option>Touch pad not working</option>
                                              </select>
                                        <div class="invalid-feedback">
                                          Please enter your Issue Type.
                                        </div>
                                      </div>
                                      <div class="mb-3">
                                            <label for="issueDescription">Description</label>
                                            <input type="text" class="form-control" id="issueDescription" placeholder="Description" required="">
                                            <div class="invalid-feedback">
                                              Please enter your Phone Number.
                                            </div>
                                          </div>  
                                  <hr class="mb-4">
                                  <div class="mb-3">
                                        <a  id="liveagent_button_online_Test" class="enabledButton btn btn-primary btn-lg btn-block"  onclick="validateLiveAgent()">Check for agent avilabality first</a>
                                        <span id="buttonVisability" >
                                          <a id="liveagent_button_online_5730b000000GnqQ" href="javascript://Chat" class="enabledButton btn btn-primary btn-lg btn-block"  style="display: none;" onclick="liveagent.startChat('5730b000000GnqQ')">Start Chat</a>
                                          <!--<a id="liveagent_button_online_5730b000000Gnrk" href="javascript://Chat" class="enabledButton btn btn-primary btn-lg btn-block"  style="display: none;" onclick="liveagent.startChat('5730b000000Gnrk')">Start Chat</a>-->
                                        </span>
                                          <div id="liveagent_button_offline_5730b000000GnqQ" href="javascript://Chat" class="" style="display: none;" >Agent not Avilable</div>
                                         <!--<div id="liveagent_button_offline_5730b000000Gnrk" href="javascript://Chat" class="" style="display: none;" >Agent not Avilable</div> -->
                                    </div>
                                </form>
                              
                </div>
            </div>
        </div>
    </div>
    <!-- Dev 3<script type='text/javascript' src='https://c.la4-c2cs-phx.salesforceliveagent.com/content/g/js/44.0/deployment.js'></script>-->
   <!-- SIT2--> <script type='text/javascript' src='https://c.la2-c1cs-iad.salesforceliveagent.com/content/g/js/44.0/deployment.js'></script>
    
    <script type="text/javascript">
    

    
        window.name = "chatchat";         
        function validateLiveAgent(){
          try{
                serviceTag = document.getElementById('serviceTag').value,
                firstName = document.getElementById('firstName').value,
                lastName = document.getElementById('lastName').value,
                emailId = document.getElementById('emailId').value,
                phoneNumber = document.getElementById('phoneNumber').value,
                issueType = document.getElementById('issueType').value,
                issueDescription = document.getElementById('issueDescription').value;
                var liveAgentObject = {
                  serviceTag : serviceTag,
                  firstName : firstName,
                  lastName : lastName,
                  emailId : lastName,
                  phoneNumber : phoneNumber,
                  issueType : issueType,
                  issueDescription : issueDescription,
                  
                }
                //liveagent.init().preventDefault();
                
                



                
              // liveagent.init('https://d.la2-c1cs-iad.salesforceliveagent.com/chat', '5720b000000CbfS', '00D4F0000000TPX');//SIT2 GE4
              //liveagent.init('https://d.la4-c2cs-phx.salesforceliveagent.com/chat', '5720b000000CbfS', '00Dq0000000CkWo');//Dev3
              liveagent.init('https://d.la2-c2cs-iad.salesforceliveagent.com/chat', '5720b000000CbfS', '00D2a0000008ftq'); 
              if (!window._laq) { window._laq = []; }
                window._laq.push(function(){
                  
                      liveagent.showWhenOnline('5730b000000GnqQ', document.getElementById('liveagent_button_online_5730b000000GnqQ'));
                      liveagent.showWhenOffline('5730b000000GnqQ', document.getElementById('liveagent_button_offline_5730b000000GnqQ'));

                     // liveagent.showWhenOnline('5730b000000Gnrk', document.getElementById('liveagent_button_online_5730b000000Gnrk'));
                     // liveagent.showWhenOffline('5730b000000Gnrk', document.getElementById('liveagent_button_offline_5730b000000Gnrk'));
                  });
           // document.getElementById("liveagent_button_online_Test").click();
                
           var observer = new MutationObserver(function(mutations) {
          mutations.forEach(function(mutation) {
            if(mutation.attributeName === 'style'){
              mutationTargetID = mutation.target.id;
              console.log("Value:"+document.getElementById(mutationTargetID).style.display);
              if(document.getElementById(mutationTargetID).style.display != "none"){
                console.log("working");
                debugger;
                //liveagent.startChat('5730b000000GnqQ');

                  //liveagent.startChatWithWindow("5730b000000GnqQ", 'chatchat'); 
                //liveagent.startChat ('5730b000000GnqQ');
                
              }
            }
          });    
        });
        var observerConfig = {
          attributes: true, 
          attributeFilter: ["style"]
        }; 
        var targetNode = document.getElementById('liveagent_button_online_5730b000000GnqQ');
        observer.observe(targetNode, observerConfig); 

              liveagent.addCustomDetail('serviceTag', serviceTag).saveToTranscript('Service_Tag__c');
              liveagent.addCustomDetail("First Name", firstName).saveToTranscript('FirstName__c');
              liveagent.addCustomDetail("Last Name", lastName).saveToTranscript('LastName__c');
              liveagent.addCustomDetail("Phone Number", phoneNumber).saveToTranscript('ContactNumber__c');
              liveagent.addCustomDetail("Email ID", emailId).saveToTranscript('Email__c');
              liveagent.addCustomDetail("Issue Type", issueType).saveToTranscript('Issue__c');
              liveagent.addCustomDetail("Issue Description", issueDescription).saveToTranscript('Description__c');
              liveagent.findOrCreate("Asset").map("Asset__c", serviceTag, true, false, false).showOnCreate(); 
              liveagent.setName(firstName + ' ' + lastName);  
        }catch(e){
          console.log(e);
          
        }

           // document.getElementById("liveagent_button_online_5730b000000GnqQ").click();
      } 
       // Notify me of style changes
               
        </script>  
        
</body>
</html>